#!/bin/bash

############################################################################################
####################### HOW TO RUN THIS FILE: > `bash -x -v lock.sh` #######################
############################################################################################

# ----------------------------------------------------------------------------------------------------------------------------------------------------
# @description: Get Absolute Path of this file in Linux System.
# @see {@link https://unix.stackexchange.com/questions/351916/get-the-parent-directory-of-a-given-file/}.
# ----------------------------------------------------------------------------------------------------------------------------------------------------
FILE_PATH=$(readlink -f "$0");

# ----------------------------------------------------------------------------------------------------------------------------------------------------
# @description: Get Parent Directory of this file in Linux System.
# @see {@link https://unix.stackexchange.com/questions/351916/get-the-parent-directory-of-a-given-file/}.
# ----------------------------------------------------------------------------------------------------------------------------------------------------
FOLDER_PATH="${FILE_PATH%/*}";

# ----------------------------------------------------------------------------------------------------------------------------------------------------
# @description: Get Project Directory of this file in Linux System.
# @see {@link https://unix.stackexchange.com/questions/351916/get-the-parent-directory-of-a-given-file/}.
# ----------------------------------------------------------------------------------------------------------------------------------------------------
# shellcheck disable=SC2034
# ----------------------------------------------------------------------------------------------------------------------------------------------------
PROJECT_PATH="${FOLDER_PATH%/*}";

# ----------------------------------------------------------------------------------------------------------------------------------------------------
# @description: Execute the Ansible Bootstrap Process via Bash Internal Process.
# @see {@link https://superuser.com/questions/653951/how-to-remove-read-only-attribute-recursively-on-windows/}.
# ----------------------------------------------------------------------------------------------------------------------------------------------------
cd "$FOLDER_PATH" || exit ;

# ----------------------------------------------------------------------------------------------------------------------------------------------------
# @description: All nested Directory within Terraform Modules (Only Directories).
# ----------------------------------------------------------------------------------------------------------------------------------------------------
# shellcheck disable=SC2034
# ----------------------------------------------------------------------------------------------------------------------------------------------------
DIR=$(find ./terraform/modules -type d) ;

for path in $DIR; do
    attrib +r "$path/*.*" 2> /dev/null ;
done ;

# ----------------------------------------------------------------------------------------------------------------------------------------------------
# @description: All nested Directory within Terraform Projects (Only Directories).
# ----------------------------------------------------------------------------------------------------------------------------------------------------
# shellcheck disable=SC2034
# ----------------------------------------------------------------------------------------------------------------------------------------------------
DIR=$(find ./terraform/projects -type d) ;

for path in $DIR; do
    attrib +r "$path/*.*" 2> /dev/null ;
done ;
